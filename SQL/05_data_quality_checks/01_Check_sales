DETACH DATABASE IF EXISTS l0;
DETACH DATABASE IF EXISTS l1;
DETACH DATABASE IF EXISTS l2;

ATTACH 'SQL/L0_forecast_accuracy.duckdb' AS l0 (READ_ONLY);
ATTACH 'SQL/L1_forecast_accuracy.duckdb' AS l1 (READ_ONLY);
ATTACH 'SQL/L2_forecast_accuracy.duckdb' AS l2 (READ_ONLY);

-- âœ… Explicit counts for key tables
SELECT 'dim_calendar'        AS table_name,
       (SELECT COUNT(*) FROM l0.calendar) AS l0_rows,
       (SELECT COUNT(*) FROM l1.dim_calendar) AS l1_rows,
       (SELECT COUNT(*) FROM l2.dim_calendar) AS l2_rows
UNION ALL
SELECT 'dim_product',
       NULL,
       (SELECT COUNT(*) FROM l1.dim_product),
       (SELECT COUNT(*) FROM l2.dim_product)
UNION ALL
SELECT 'dim_store',
       NULL,
       (SELECT COUNT(*) FROM l1.dim_store),
       (SELECT COUNT(*) FROM l2.dim_store)
UNION ALL
SELECT 'fact_sales_enriched',
       NULL,
       (SELECT COUNT(*) FROM l1.l1_sales_long),
       (SELECT COUNT(*) FROM l2.l2_sales_long)
ORDER BY table_name;


